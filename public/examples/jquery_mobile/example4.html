<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Armenian Poets</title>

        <link rel="stylesheet" href="lib/jquery.mobile-1.2.0.min.css"/>
        <script src="lib/jquery-1.8.2.min.js"></script>

        <!-- Adding deafult button -->
        <script type="text/javascript">
            $(document).bind('mobileinit', function(){
                $.mobile.page.prototype.options.addBackBtn = true;
            });
        </script>


        <!-- fade is the default transition style -->
        <script type="text/javascript">
            $(document).bind('mobileinit', function(){
                $.mobile.defaultPageTransition = "flip";
            });
        </script>

        <script src="lib/jquery.mobile-1.2.0.min.js"></script>

        <!-- to avoid header text from being
               truncated overwrite the margin -->
        <style type="text/css">
            .ui-header .ui-title {
                margin-right: 10%;
                margin-left: 10%;
            }
        </style>
    </head>

    <body>

        <div data-role="page" id="mainPage">
            <div data-role="header" data-position="fixed">
                <h4>Armenian Poets</h4>
            </div>
            <div data-role="content">
                <div data-role="content">
                    <ul data-role="listview" data-inset="true" data-filter="true" id="movieList">

                    </ul>
                </div>
            </div>
        </div>


        <script type="text/javascript">

            $.getJSON("amPoets.json", function (movies) {
                //Start off with an empty list every time to get the latest from server
                $('#movieList').empty();

                //add the movie items as list
                $.each(movies, function (i, movie) {
                    $('#movieList').append(generateMovieLink(movie));
                });

                //refresh the list view to show the latest changes
                $('#movieList').listview('refresh');

            });

            //creates a movie link list item
            function generateMovieLink(movie) {

                //debugger;
                return '<li><a href="javascript:void(0)'
                        + '" onclick="goToMovieDetailPage(\''
                        + movie.name
                        + '\',\''
                        + movie.picUrl + '\')">'
                        + movie.name
                        + '</a></li>';
            }

            function goToMovieDetailPage(movieName, moviePicUrl) {

                var id = movieName;
                var moviePage = $("#" + movieName);

                //create the page html template
                if (moviePage.length === 0) {
                    moviePage = $("<div id='" + id + "' data-role='page' data-url=dummyUrl><div data-role='header' data-position='fixed'><h1>"
                            + movieName + "</h1></div><div data-role='content'><img src='"
                            + moviePicUrl + "'></div><div data-role='footer' data-position='fixed'><h4>"
                            + movieName + "</h4></div></div>");

                    //append the new page to the page container
                    moviePage.appendTo($.mobile.pageContainer);
                }

                //go to the newly created page
                $.mobile.changePage(moviePage);
            }
        </script>

    </body>
</html>